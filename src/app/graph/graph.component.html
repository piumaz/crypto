
<form [formGroup]="uiForm" class="md:flex md:flex-row md:gap-6 items-end">
  <div class="mb-2">
<!--    <label>Select Market:</label>-->
    <mat-chip-list #symbolList>
      <input
        placeholder="Search market..."
        #symbolsInput
        type="text" formControlName="symbols"
        [matAutocomplete]="auto"
        [matChipInputFor]= "symbolList">
    </mat-chip-list>
    <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selectedManagedSymbol($event)">
      <mat-option *ngFor="let item of getFilteresManagedSymbols()" [value]="item.id">
        {{item.id}}
      </mat-option>
    </mat-autocomplete>

  </div>

</form>

<div class="my-2">
  <mat-chip
    *ngFor="let symbol of getSelectedManagedSymbols()"
    [selectable]="false"
    [removable]="true"
    (removed)="removeSelectedManagedSymbols(symbol)">
    {{symbol}}
    <mat-icon matChipRemove>cancel</mat-icon>
  </mat-chip>
</div>

<div *ngIf="chartData.length" class="rounded-lg ring-1 ring-gray-900 ring-opacity-5 my-4">
  <app-charts style="height:300px"
    type="line"
    legendPosition="right"
    [legend]="false"
    [scheme]="colorScheme"
    [showGridLines]="true"
    [xAxis]="false"
    [yAxis]="true"
    [showXAxisLabel]="false"
    [showYAxisLabel]="false"
    [timeline]="false"
    [results]="chartData"></app-charts>
</div>

<div *ngIf="history.length" class="my-4">

  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th *ngFor="let currency of getProductsId(); let i = index" class="px-6 py-3 text-center font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap">
          <div [style.color]="colorScheme.domain[i]"><strong>{{currency}}</strong></div>
          <div class="text-xs">
            <!--Average:-->
            {{average[currency]}}<br/>
            <!--Rate:-->
            <span class="rounded-md ring-1 ring-gray-900 ring-opacity-5 px-1" [class.grey]="rate[currency] == 0" [class.green]="rate[currency] > 0" [class.red]="rate[currency] < 0">
              {{rate[currency]}}%
            </span>
          </div>
        </th>
      </tr>
    </thead>

    <tbody class="bg-white divide-y divide-gray-200">
      <tr *ngFor="let item of history.slice(0, 10); let i = index">
        <td *ngFor="let currency of getProductsId()" class="px-6 py-4 whitespace-nowrap text-right">

          <ng-container *ngIf="item[currency] && item[currency].price">
            <span class="price" [style.color]="getPriceColor(item[currency].price, history[i+1] && history[i+1][currency] ? history[i+1][currency].price : item[currency].price)">
              <ng-container [ngSwitch]="getPriceColor(item[currency].price, history[i+1] && history[i+1][currency]? history[i+1][currency].price : item[currency].price)">
                <mat-icon *ngSwitchCase="'red'">arrow_downward</mat-icon>
                <mat-icon *ngSwitchCase="'green'">arrow_upward</mat-icon>
              </ng-container>
              <span>{{item[currency].price}}</span>
            </span>
          </ng-container>

        </td>
      </tr>
    </tbody>
  </table>

</div>
